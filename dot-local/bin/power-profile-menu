#! /bin/sh

options="\
Power-saver
Balanced
Performance"

# Get the currently active profile from powerprofilesctl
# and add a hint to its corresponding menu option
currProfile=$(powerprofilesctl get)
options=$(echo "$options" | sed "s/$currProfile/& (Active)/I")

optionCount=$(echo "$options" | wc -l)

# Select an option with fzf
selection=$(
    echo "$options" | \
    fzf-popup 27x$((optionCount+4)) \
        --no-multi --no-input --margin 0,1,1 \
        --cycle --accept-nth 1 \
        --header '  Select a Profile' \
        --header-border rounded \
)

# If a selection was made, use powerprofilesctl
# to change to the corresponding profile
if [[ -n $selection ]]; then
    selection=$(echo "$selection" | tr '[:upper:]' '[:lower:]')
    powerprofilesctl set "$selection"
fi
